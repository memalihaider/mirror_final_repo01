"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{931:(e,a,i)=>{i.d(a,{A:()=>r});var l=i(95155),s=i(12115),t=i(40283),n=i(35695);function r(e){let{children:a}=e,{userRole:i,loading:r}=(0,t.A)(),u=(0,n.usePathname)(),c=(0,n.useRouter)(),[d,o]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{if(!r&&i){let e=u.split("/")[1]||"dashboard",a=i.accessPages||[];"admin"===i.role||a.includes(e)?o(!0):(o(!1),c.replace("/access-denied"))}},[r,i,u,c]),r||!i)?(0,l.jsxs)("div",{className:"flex justify-center items-center h-screen",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-pink-600"}),(0,l.jsx)("span",{className:"ml-3 text-pink-600",children:"Checking access..."})]}):d?(0,l.jsx)(l.Fragment,{children:a}):null}},40283:(e,a,i)=>{i.d(a,{A:()=>u,O:()=>c});var l=i(95155),s=i(12115),t=i(79323),n=i(56104);let r=(0,s.createContext)({user:null,userRole:null,loading:!0,isAdmin:!1,error:null,accessiblePages:[],canAccessPage:()=>!1}),u=()=>(0,s.useContext)(r),c=e=>{let{children:a}=e,[i,u]=(0,s.useState)(null),[c,d]=(0,s.useState)(null),[o,m]=(0,s.useState)(!0),[h,f]=(0,s.useState)(null),[g,p]=(0,s.useState)([]);(0,s.useEffect)(()=>{let e,a=!0;return(async()=>{try{m(!0),await (0,n.AU)(),e=(0,t.Bh)(async e=>{if(a){if(u(e),f(null),e)try{let i=await (0,t.uG)(e.uid);if(!i&&e.email){let a="ahmadxeikh786@gmail.com"===e.email?"admin":"user";await (0,t.yS)(e.uid,e.email,a,e.displayName||void 0,[]),i=await (0,t.uG)(e.uid)}(null==i?void 0:i.role)!=="admin"&&"ahmadxeikh786@gmail.com"===e.email&&(await (0,t.yS)(e.uid,e.email,"admin",e.displayName||void 0,[]),i=await (0,t.uG)(e.uid)),a&&(d(i),p((null==i?void 0:i.accessPages)||[]))}catch(e){console.error("Error getting user role:",e),a&&f("Failed to load user role")}else a&&(d(null),p([]));a&&m(!1)}})}catch(e){console.error("Firebase initialization error:",e),a&&(f("Failed to initialize authentication"),m(!1))}})(),()=>{a=!1,e&&e()}},[]);let v=(null==c?void 0:c.role)==="admin";return(0,l.jsx)(r.Provider,{value:{user:i,userRole:c,loading:o,isAdmin:v,error:h,accessiblePages:g,canAccessPage:e=>!!c&&("admin"===c.role||g.includes(e))},children:a})}}}]);