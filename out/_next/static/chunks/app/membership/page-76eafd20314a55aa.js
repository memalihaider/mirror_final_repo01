(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4119],{931:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});var n=s(95155),i=s(12115),a=s(40283),r=s(35695);function l(e){let{children:t}=e,{userRole:s,loading:l}=(0,a.A)(),o=(0,r.usePathname)(),c=(0,r.useRouter)(),[d,m]=(0,i.useState)(!1);return((0,i.useEffect)(()=>{if(!l&&s){let e=o.split("/")[1]||"dashboard",t=s.accessPages||[];"admin"===s.role||t.includes(e)?m(!0):(m(!1),c.replace("/access-denied"))}},[l,s,o,c]),l||!s)?(0,n.jsxs)("div",{className:"flex justify-center items-center h-screen",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-pink-600"}),(0,n.jsx)("span",{className:"ml-3 text-pink-600",children:"Checking access..."})]}):d?(0,n.jsx)(n.Fragment,{children:t}):null}},11742:(e,t,s)=>{Promise.resolve().then(s.bind(s,58983))},40283:(e,t,s)=>{"use strict";s.d(t,{A:()=>o,O:()=>c});var n=s(95155),i=s(12115),a=s(79323),r=s(56104);let l=(0,i.createContext)({user:null,userRole:null,loading:!0,isAdmin:!1,error:null,accessiblePages:[],canAccessPage:()=>!1}),o=()=>(0,i.useContext)(l),c=e=>{let{children:t}=e,[s,o]=(0,i.useState)(null),[c,d]=(0,i.useState)(null),[m,u]=(0,i.useState)(!0),[h,p]=(0,i.useState)(null),[x,b]=(0,i.useState)([]);(0,i.useEffect)(()=>{let e,t=!0;return(async()=>{try{u(!0),await (0,r.AU)(),e=(0,a.Bh)(async e=>{if(t){if(o(e),p(null),e)try{let s=await (0,a.uG)(e.uid);if(!s&&e.email){let t="ahmadxeikh786@gmail.com"===e.email?"admin":"user";await (0,a.yS)(e.uid,e.email,t,e.displayName||void 0,[]),s=await (0,a.uG)(e.uid)}(null==s?void 0:s.role)!=="admin"&&"ahmadxeikh786@gmail.com"===e.email&&(await (0,a.yS)(e.uid,e.email,"admin",e.displayName||void 0,[]),s=await (0,a.uG)(e.uid)),t&&(d(s),b((null==s?void 0:s.accessPages)||[]))}catch(e){console.error("Error getting user role:",e),t&&p("Failed to load user role")}else t&&(d(null),b([]));t&&u(!1)}})}catch(e){console.error("Firebase initialization error:",e),t&&(p("Failed to initialize authentication"),u(!1))}})(),()=>{t=!1,e&&e()}},[]);let g=(null==c?void 0:c.role)==="admin";return(0,n.jsx)(l.Provider,{value:{user:s,userRole:c,loading:m,isAdmin:g,error:h,accessiblePages:x,canAccessPage:e=>!!c&&("admin"===c.role||x.includes(e))},children:t})}},54416:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});let n=(0,s(19946).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},58983:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var n=s(95155),i=s(12115),a=s(84616);let r=(0,s(19946).A)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);var l=s(62525),o=s(54416),c=s(60760),d=s(38274),m=s(40283),u=s(35695),h=s(35317),p=s(56104),x=s(931);function b(){let{user:e}=(0,m.A)();(0,u.useRouter)();let[t,s]=(0,i.useState)([]),[b,g]=(0,i.useState)([]),[y,f]=(0,i.useState)([]),[v,j]=(0,i.useState)([]),[k,N]=(0,i.useState)([]),[w,S]=(0,i.useState)([]),[C,P]=(0,i.useState)([]),[A,M]=(0,i.useState)(!0),[E,R]=(0,i.useState)(!1),[z,O]=(0,i.useState)(null),[F,L]=(0,i.useState)("membership"),[_,D]=(0,i.useState)({name:"",description:"",spending:"",points:"",number:"",discount:""}),[I,G]=(0,i.useState)(!1);(0,i.useEffect)(()=>{if(p.db){M(!0);try{let e=Object.entries({memberships:"memberships",loyaltyPoints:"loyaltyPoints",bookingRestrictions:"bookingRestrictions",smsContents:"smsContents",paymentMethods:"paymentMethods",cashbackPrograms:"cashbackPrograms",termsConditions:"termsAndConditions"}).map(e=>{let[t,n]=e,i=(0,h.rJ)(p.db,n);return(0,h.aQ)((0,h.P)(i,(0,h.My)("createdAt","asc")),e=>{let n=e.docs.map(e=>({id:e.id,...e.data()}));switch(t){case"memberships":s(n);break;case"loyaltyPoints":g(n);break;case"bookingRestrictions":f(n);break;case"smsContents":j(n);break;case"paymentMethods":N(n);break;case"cashbackPrograms":S(n);break;case"termsConditions":P(n)}})});return M(!1),()=>e.forEach(e=>e())}catch(e){console.error("subscribe error:",e),M(!1)}}},[]);let H=()=>{R(!1),O(null),D({name:"",description:"",spending:"",points:"",number:"",discount:""}),G(!1)},U=async e=>{if(null==e||e.preventDefault(),p.db){G(!0);try{let e={name:_.name.trim(),description:_.description.trim(),createdAt:(0,h.O5)()};"membership"===F&&(e.spending=Number(_.spending)),"loyalty"===F&&(e.points=Number(_.points)),"restriction"===F&&(delete e.name,e.number=Number(_.number)),"cashback"===F&&(delete e.name,delete e.description,e.spending=Number(_.spending),e.discount=Number(_.discount));let t={membership:"memberships",loyalty:"loyaltyPoints",restriction:"bookingRestrictions",sms:"smsContents",payment:"paymentMethods",cashback:"cashbackPrograms",terms:"termsAndConditions"}[F];z?await (0,h.mZ)((0,h.H9)(p.db,t,z),{...e,updatedAt:(0,h.O5)()}):await (0,h.gS)((0,h.rJ)(p.db,t),e),H()}catch(e){console.error("save error:",e),alert("Error saving item. See console."),G(!1)}}},q=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"membership";if(e&&confirm("Are you sure you want to delete this item?"))try{await (0,h.kd)((0,h.H9)(p.db,{membership:"memberships",loyalty:"loyaltyPoints",restriction:"bookingRestrictions",sms:"smsContents",payment:"paymentMethods",cashback:"cashbackPrograms",terms:"termsAndConditions"}[t],e))}catch(e){console.error("delete error:",e),alert("Error deleting. See console.")}},B=(e,t,s,i)=>(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,n.jsx)("h2",{className:"text-2xl font-semibold ".concat(t),children:e}),(0,n.jsxs)("button",{onClick:()=>{D({name:"",description:"",spending:"",points:"",number:"",discount:""}),O(null),L(s),R(!0)},className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg text-white shadow-lg ".concat(t.replace("text-","bg-")," hover:scale-[1.01] transition"),children:[(0,n.jsx)(a.A,{className:"w-4 h-4 text-black"}),(0,n.jsx)("p",{className:"text-black",children:"Add"})]})]}),A?(0,n.jsx)("div",{className:"p-6 rounded-lg bg-white/80",children:"Loading..."}):0===i.length?(0,n.jsx)("div",{className:"p-6 rounded-lg bg-white/80 text-center",children:"No items yet. Click “Add” to create one."}):(0,n.jsx)("div",{className:"grid gap-4 md:grid-cols-3",children:i.map(e=>(0,n.jsx)("div",{className:"bg-white/90 dark:bg-gray-900 p-4 rounded-2xl border shadow",children:(0,n.jsxs)("div",{className:"flex items-start justify-between",children:[(0,n.jsxs)("div",{children:[e.name&&(0,n.jsx)("h3",{className:"text-lg font-semibold ".concat(t),children:e.name}),e.description&&(0,n.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),e.spending&&(0,n.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Spending: ",e.spending,e.discount?" | Discount: ".concat(e.discount,"%"):""]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("button",{onClick:()=>{var t,n,i,a;D({name:e.name||"",description:e.description||"",spending:("membership"===s||"cashback"===s)&&(null==(t=e.spending)?void 0:t.toString())||"",points:"loyalty"===s&&(null==(n=e.points)?void 0:n.toString())||"",number:"restriction"===s&&(null==(i=e.number)?void 0:i.toString())||"",discount:"cashback"===s&&(null==(a=e.discount)?void 0:a.toString())||""}),O(e.id||null),L(s),R(!0)},className:"p-1 hover:bg-gray-100 rounded-md",children:(0,n.jsx)(r,{className:"w-4 h-4"})}),(0,n.jsx)("button",{onClick:()=>q(e.id,s),className:"p-1 hover:bg-red-50 rounded-md",children:(0,n.jsx)(l.A,{className:"w-4 h-4 text-red-600"})})]})]})},e.id))})]});return(0,n.jsxs)(x.A,{children:[(0,n.jsxs)("div",{className:"p-6 max-w-5xl mx-auto space-y-10",children:[B("Memberships","text-indigo-600","membership",t),B("Loyalty Points","text-emerald-600","loyalty",b),B("Booking Restrictions","text-rose-600","restriction",y),B("SMS Content (COMING SOON)","text-cyan-600","sms",v),B("Payment Methods","text-amber-600","payment",k),B("Cashback Programs","text-pink-600","cashback",w),B("Terms & Conditions","text-blue-600","terms",C)]}),(0,n.jsx)(c.N,{children:E&&(0,n.jsxs)(d.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,n.jsx)(d.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:H}),(0,n.jsxs)(d.P.form,{initial:{y:-20,opacity:0,scale:.98},animate:{y:0,opacity:1,scale:1},exit:{y:10,opacity:0,scale:.98},transition:{type:"spring",stiffness:400,damping:28},onSubmit:U,className:"relative z-50 w-full max-w-lg bg-white/95 dark:bg-gray-900/95 rounded-2xl p-6 shadow-xl border",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("h4",{className:"text-sm font-medium capitalize",children:z?"Edit ".concat(F):"New ".concat(F)}),(0,n.jsx)("button",{type:"button",onClick:H,className:"p-1 rounded-md hover:bg-gray-100",children:(0,n.jsx)(o.A,{className:"w-4 h-4"})})]}),(0,n.jsx)("div",{className:"space-y-4",children:"cashback"===F?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Spending"}),(0,n.jsx)("input",{value:_.spending,onChange:e=>D(t=>({...t,spending:e.target.value})),className:"w-full px-3 py-2 rounded-lg border bg-white text-sm",placeholder:"Enter spending amount",required:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Discount (%)"}),(0,n.jsx)("input",{value:_.discount,onChange:e=>D(t=>({...t,discount:e.target.value})),className:"w-full px-3 py-2 rounded-lg border bg-white text-sm",placeholder:"Enter discount percentage",required:!0})]})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Name"}),(0,n.jsx)("input",{value:_.name,onChange:e=>D(t=>({...t,name:e.target.value})),className:"w-full px-3 py-2 rounded-lg border bg-white text-sm",placeholder:"Enter name",required:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Description"}),(0,n.jsx)("textarea",{value:_.description,onChange:e=>D(t=>({...t,description:e.target.value})),className:"w-full px-3 py-2 rounded-lg border bg-white text-sm min-h-[80px]",placeholder:"Short description"})]})]})}),(0,n.jsxs)("div",{className:"mt-6 flex items-center justify-end gap-2",children:[(0,n.jsx)("button",{type:"button",onClick:H,className:"px-4 py-2 text-sm rounded-lg border bg-gray-50 hover:bg-gray-100",children:"Cancel"}),(0,n.jsx)("button",{type:"submit",disabled:I,className:"px-4 py-2 text-sm rounded-lg bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50",children:I?"Saving...":z?"Update":"Save"})]})]},"modal-panel")]},"modal-overlay")})]})}},60760:(e,t,s)=>{"use strict";s.d(t,{N:()=>y});var n=s(95155),i=s(12115),a=s(90869),r=s(82885),l=s(97494),o=s(80845),c=s(27351),d=s(51508);class m extends i.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,s=(0,c.s)(e)&&e.offsetWidth||0,n=this.props.sizeRef.current;n.height=t.offsetHeight||0,n.width=t.offsetWidth||0,n.top=t.offsetTop,n.left=t.offsetLeft,n.right=s-n.width-n.left}return null}componentDidUpdate(){}render(){return this.props.children}}function u(e){let{children:t,isPresent:s,anchorX:a,root:r}=e,l=(0,i.useId)(),o=(0,i.useRef)(null),c=(0,i.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:u}=(0,i.useContext)(d.Q);return(0,i.useInsertionEffect)(()=>{let{width:e,height:t,top:n,left:i,right:d}=c.current;if(s||!o.current||!e||!t)return;o.current.dataset.motionPopId=l;let m=document.createElement("style");u&&(m.nonce=u);let h=null!=r?r:document.head;return h.appendChild(m),m.sheet&&m.sheet.insertRule('\n          [data-motion-pop-id="'.concat(l,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            ").concat("left"===a?"left: ".concat(i):"right: ".concat(d),"px !important;\n            top: ").concat(n,"px !important;\n          }\n        ")),()=>{h.contains(m)&&h.removeChild(m)}},[s]),(0,n.jsx)(m,{isPresent:s,childRef:o,sizeRef:c,children:i.cloneElement(t,{ref:o})})}let h=e=>{let{children:t,initial:s,isPresent:a,onExitComplete:l,custom:c,presenceAffectsLayout:d,mode:m,anchorX:h,root:x}=e,b=(0,r.M)(p),g=(0,i.useId)(),y=!0,f=(0,i.useMemo)(()=>(y=!1,{id:g,initial:s,isPresent:a,custom:c,onExitComplete:e=>{for(let t of(b.set(e,!0),b.values()))if(!t)return;l&&l()},register:e=>(b.set(e,!1),()=>b.delete(e))}),[a,b,l]);return d&&y&&(f={...f}),(0,i.useMemo)(()=>{b.forEach((e,t)=>b.set(t,!1))},[a]),i.useEffect(()=>{a||b.size||!l||l()},[a]),"popLayout"===m&&(t=(0,n.jsx)(u,{isPresent:a,anchorX:h,root:x,children:t})),(0,n.jsx)(o.t.Provider,{value:f,children:t})};function p(){return new Map}var x=s(32082);let b=e=>e.key||"";function g(e){let t=[];return i.Children.forEach(e,e=>{(0,i.isValidElement)(e)&&t.push(e)}),t}let y=e=>{let{children:t,custom:s,initial:o=!0,onExitComplete:c,presenceAffectsLayout:d=!0,mode:m="sync",propagate:u=!1,anchorX:p="left",root:y}=e,[f,v]=(0,x.xQ)(u),j=(0,i.useMemo)(()=>g(t),[t]),k=u&&!f?[]:j.map(b),N=(0,i.useRef)(!0),w=(0,i.useRef)(j),S=(0,r.M)(()=>new Map),[C,P]=(0,i.useState)(j),[A,M]=(0,i.useState)(j);(0,l.E)(()=>{N.current=!1,w.current=j;for(let e=0;e<A.length;e++){let t=b(A[e]);k.includes(t)?S.delete(t):!0!==S.get(t)&&S.set(t,!1)}},[A,k.length,k.join("-")]);let E=[];if(j!==C){let e=[...j];for(let t=0;t<A.length;t++){let s=A[t],n=b(s);k.includes(n)||(e.splice(t,0,s),E.push(s))}return"wait"===m&&E.length&&(e=E),M(g(e)),P(j),null}let{forceRender:R}=(0,i.useContext)(a.L);return(0,n.jsx)(n.Fragment,{children:A.map(e=>{let t=b(e),i=(!u||!!f)&&(j===A||k.includes(t));return(0,n.jsx)(h,{isPresent:i,initial:(!N.current||!!o)&&void 0,custom:s,presenceAffectsLayout:d,mode:m,root:y,onExitComplete:i?void 0:()=>{if(!S.has(t))return;S.set(t,!0);let e=!0;S.forEach(t=>{t||(e=!1)}),e&&(null==R||R(),M(w.current),u&&(null==v||v()),c&&c())},anchorX:p,children:e},t)})})}},62525:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});let n=(0,s(19946).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},84616:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});let n=(0,s(19946).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])}},e=>{e.O(0,[9135,7210,1748,6061,9323,8441,5964,7358],()=>e(e.s=11742)),_N_E=e.O()}]);