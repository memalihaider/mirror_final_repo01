(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4119],{4229:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});let i=(0,s(19946).A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},35695:(e,t,s)=>{"use strict";var i=s(18999);s.o(i,"usePathname")&&s.d(t,{usePathname:function(){return i.usePathname}}),s.o(i,"useRouter")&&s.d(t,{useRouter:function(){return i.useRouter}})},39342:(e,t,s)=>{Promise.resolve().then(s.bind(s,58983))},40283:(e,t,s)=>{"use strict";s.d(t,{A:()=>d,O:()=>o});var i=s(95155),r=s(12115),n=s(79323),a=s(56104);let l=(0,r.createContext)({user:null,userRole:null,loading:!0,isAdmin:!1,error:null,accessiblePages:[],canAccessPage:()=>!1}),d=()=>(0,r.useContext)(l),o=e=>{let{children:t}=e,[s,d]=(0,r.useState)(null),[o,c]=(0,r.useState)(null),[m,u]=(0,r.useState)(!0),[h,p]=(0,r.useState)(null),[x,g]=(0,r.useState)([]);(0,r.useEffect)(()=>{let e,t=!0;return(async()=>{try{u(!0),await (0,a.AU)(),e=(0,n.Bh)(async e=>{if(t){if(d(e),p(null),e)try{let s=await (0,n.uG)(e.uid);if(!s&&e.email){let t="ahmadxeikh786@gmail.com"===e.email?"admin":"user";await (0,n.yS)(e.uid,e.email,t,e.displayName||void 0,[]),s=await (0,n.uG)(e.uid)}(null==s?void 0:s.role)!=="admin"&&"ahmadxeikh786@gmail.com"===e.email&&(await (0,n.yS)(e.uid,e.email,"admin",e.displayName||void 0,[]),s=await (0,n.uG)(e.uid)),t&&(c(s),g((null==s?void 0:s.accessPages)||[]))}catch(e){console.error("Error getting user role:",e),t&&p("Failed to load user role")}else t&&(c(null),g([]));t&&u(!1)}})}catch(e){console.error("Firebase initialization error:",e),t&&(p("Failed to initialize authentication"),u(!1))}})(),()=>{t=!1,e&&e()}},[]);let b=(null==o?void 0:o.role)==="admin";return(0,i.jsx)(l.Provider,{value:{user:s,userRole:o,loading:m,isAdmin:b,error:h,accessiblePages:x,canAccessPage:e=>!!o&&("admin"===o.role||x.includes(e))},children:t})}},54416:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});let i=(0,s(19946).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},58983:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var i=s(95155),r=s(12115),n=s(84616);let a=(0,s(19946).A)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);var l=s(62525),d=s(54416),o=s(4229),c=s(60760),m=s(38274),u=s(40283),h=s(35695),p=s(35317),x=s(56104);function g(){let{user:e}=(0,u.A)();(0,h.useRouter)();let[t,s]=(0,r.useState)([]),[g,b]=(0,r.useState)([]),[y,f]=(0,r.useState)([]),[v,j]=(0,r.useState)(!0),[N,w]=(0,r.useState)(!1),[k,A]=(0,r.useState)(null),[P,C]=(0,r.useState)("membership"),[S,M]=(0,r.useState)({name:"",description:"",spending:"",points:"",number:""}),[E,R]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(x.db){j(!0);try{let e=(0,p.rJ)(x.db,"memberships"),t=(0,p.rJ)(x.db,"loyaltyPoints"),i=(0,p.rJ)(x.db,"bookingRestrictions"),r=(0,p.P)(e,(0,p.My)("createdAt","asc")),n=(0,p.aQ)(r,e=>{s(e.docs.map(e=>({id:e.id,...e.data()})))}),a=(0,p.P)(t,(0,p.My)("createdAt","asc")),l=(0,p.aQ)(a,e=>{b(e.docs.map(e=>({id:e.id,...e.data()})))}),d=(0,p.P)(i,(0,p.My)("createdAt","asc")),o=(0,p.aQ)(d,e=>{f(e.docs.map(e=>({id:e.id,...e.data()}))),j(!1)});return()=>{n(),l(),o()}}catch(e){console.error("subscribe error:",e),j(!1)}}},[]);let L=e=>{M({name:"",description:"",spending:"",points:"",number:""}),A(null),C(e),w(!0)},z=(e,t)=>{var s,i,r;M({name:e.name||"",description:e.description||"",spending:"membership"===t&&(null==(s=e.spending)?void 0:s.toString())||"",points:"loyalty"===t&&(null==(i=e.points)?void 0:i.toString())||"",number:"restriction"===t&&(null==(r=e.number)?void 0:r.toString())||""}),A(e.id||null),C(t),w(!0)},O=()=>{w(!1),A(null),M({name:"",description:"",spending:"",points:"",number:""}),R(!1)},H=async e=>{if(null==e||e.preventDefault(),"restriction"!==P&&!S.name.trim())return void alert("Please enter a name.");if("membership"===P&&(!S.spending||isNaN(Number(S.spending))))return void alert("Please enter a valid spending amount.");if("loyalty"===P&&(!S.points||isNaN(Number(S.points))))return void alert("Please enter a valid points value.");if("restriction"===P&&(!S.number||isNaN(Number(S.number))))return void alert("Please enter a valid number for restriction.");R(!0);try{"membership"===P?k?await (0,p.mZ)((0,p.H9)(x.db,"memberships",k),{name:S.name.trim(),description:S.description.trim(),spending:Number(S.spending),updatedAt:(0,p.O5)()}):await (0,p.gS)((0,p.rJ)(x.db,"memberships"),{name:S.name.trim(),description:S.description.trim(),spending:Number(S.spending),createdAt:(0,p.O5)()}):"loyalty"===P?k?await (0,p.mZ)((0,p.H9)(x.db,"loyaltyPoints",k),{name:S.name.trim(),description:S.description.trim(),points:Number(S.points),updatedAt:(0,p.O5)()}):await (0,p.gS)((0,p.rJ)(x.db,"loyaltyPoints"),{name:S.name.trim(),description:S.description.trim(),points:Number(S.points),createdAt:(0,p.O5)()}):"restriction"===P&&(k?await (0,p.mZ)((0,p.H9)(x.db,"bookingRestrictions",k),{number:Number(S.number),description:S.description.trim(),updatedAt:(0,p.O5)()}):await (0,p.gS)((0,p.rJ)(x.db,"bookingRestrictions"),{number:Number(S.number),description:S.description.trim(),createdAt:(0,p.O5)()})),O()}catch(e){console.error("save error:",e),alert("Error saving item. See console."),R(!1)}},J=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"membership";if(e&&confirm("Are you sure you want to delete this item?"))try{await (0,p.kd)((0,p.H9)(x.db,"membership"===t?"memberships":"loyalty"===t?"loyaltyPoints":"bookingRestrictions",e))}catch(e){console.error("delete error:",e),alert("Error deleting. See console.")}};return(0,i.jsxs)("div",{className:"p-6 max-w-5xl mx-auto space-y-10",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,i.jsx)("h2",{className:"text-2xl font-semibold text-indigo-600",children:"Memberships"}),(0,i.jsxs)("button",{onClick:()=>L("membership"),className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-gradient-to-r from-indigo-500 to-indigo-600 text-white shadow-lg hover:scale-[1.01] transition",children:[(0,i.jsx)(n.A,{className:"w-4 h-4"}),"Add Membership"]})]}),v?(0,i.jsx)("div",{className:"p-6 rounded-lg bg-white/80",children:"Loading..."}):0===t.length?(0,i.jsx)("div",{className:"p-6 rounded-lg bg-white/80 text-center",children:'No memberships yet. Click "Add Membership" to create one.'}):(0,i.jsx)("div",{className:"grid gap-4 md:grid-cols-3",children:t.map(e=>(0,i.jsx)("div",{className:"bg-white/90 dark:bg-gray-900 p-4 rounded-2xl border border-indigo-100/30 shadow",children:(0,i.jsxs)("div",{className:"flex items-start justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"text-lg font-semibold text-indigo-700",children:e.name}),(0,i.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),(0,i.jsxs)("p",{className:"text-sm font-medium text-indigo-500 mt-2",children:["Spending: ",e.spending]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("button",{onClick:()=>z(e,"membership"),className:"p-1 hover:bg-gray-100 rounded-md",children:(0,i.jsx)(a,{className:"w-4 h-4"})}),(0,i.jsx)("button",{onClick:()=>J(e.id,"membership"),className:"p-1 hover:bg-red-50 rounded-md",children:(0,i.jsx)(l.A,{className:"w-4 h-4 text-red-600"})})]})]})},e.id))})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,i.jsx)("h2",{className:"text-2xl font-semibold text-emerald-600",children:"Loyalty Points"}),(0,i.jsxs)("button",{onClick:()=>L("loyalty"),className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-gradient-to-r from-emerald-500 to-emerald-600 text-white shadow-lg hover:scale-[1.01] transition",children:[(0,i.jsx)(n.A,{className:"w-4 h-4"}),"Add Loyalty"]})]}),v?(0,i.jsx)("div",{className:"p-6 rounded-lg bg-white/80",children:"Loading..."}):0===g.length?(0,i.jsx)("div",{className:"p-6 rounded-lg bg-white/80 text-center",children:'No loyalty points yet. Click "Add Loyalty" to create one.'}):(0,i.jsx)("div",{className:"grid gap-4 md:grid-cols-3",children:g.map(e=>(0,i.jsx)("div",{className:"bg-white/90 dark:bg-gray-900 p-4 rounded-2xl border border-emerald-100/30 shadow",children:(0,i.jsxs)("div",{className:"flex items-start justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"text-lg font-semibold text-emerald-700",children:e.name}),(0,i.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),(0,i.jsxs)("p",{className:"text-sm font-medium text-emerald-500 mt-2",children:["Points: ",e.points]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("button",{onClick:()=>z(e,"loyalty"),className:"p-1 hover:bg-gray-100 rounded-md",children:(0,i.jsx)(a,{className:"w-4 h-4"})}),(0,i.jsx)("button",{onClick:()=>J(e.id,"loyalty"),className:"p-1 hover:bg-red-50 rounded-md",children:(0,i.jsx)(l.A,{className:"w-4 h-4 text-red-600"})})]})]})},e.id))})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,i.jsx)("h2",{className:"text-2xl font-semibold text-rose-600",children:"Booking Restrictions"}),(0,i.jsxs)("button",{onClick:()=>L("restriction"),className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-gradient-to-r from-rose-500 to-rose-600 text-white shadow-lg hover:scale-[1.01] transition",children:[(0,i.jsx)(n.A,{className:"w-4 h-4"}),"Add Restriction"]})]}),v?(0,i.jsx)("div",{className:"p-6 rounded-lg bg-white/80",children:"Loading..."}):0===y.length?(0,i.jsx)("div",{className:"p-6 rounded-lg bg-white/80 text-center",children:'No restrictions yet. Click "Add Restriction" to create one.'}):(0,i.jsx)("div",{className:"grid gap-4 md:grid-cols-3",children:y.map(e=>(0,i.jsx)("div",{className:"bg-white/90 dark:bg-gray-900 p-4 rounded-2xl border border-rose-100/30 shadow",children:(0,i.jsxs)("div",{className:"flex items-start justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("h3",{className:"text-lg font-semibold text-rose-700",children:["Limit: ",e.number]}),(0,i.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("button",{onClick:()=>z(e,"restriction"),className:"p-1 hover:bg-gray-100 rounded-md",children:(0,i.jsx)(a,{className:"w-4 h-4"})}),(0,i.jsx)("button",{onClick:()=>J(e.id,"restriction"),className:"p-1 hover:bg-red-50 rounded-md",children:(0,i.jsx)(l.A,{className:"w-4 h-4 text-red-600"})})]})]})},e.id))})]}),(0,i.jsx)(c.N,{children:N&&(0,i.jsxs)(m.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,i.jsx)(m.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:O}),(0,i.jsxs)(m.P.form,{initial:{y:-20,opacity:0,scale:.98},animate:{y:0,opacity:1,scale:1},exit:{y:10,opacity:0,scale:.98},transition:{type:"spring",stiffness:400,damping:28},onSubmit:H,className:"relative z-50 w-full max-w-lg bg-white/95 dark:bg-gray-900/95 rounded-2xl p-6 shadow-xl border",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,i.jsx)("h4",{className:"text-sm font-medium",children:k?"Edit ".concat("membership"===P?"Membership":"loyalty"===P?"Loyalty Point":"Restriction"):"New ".concat("membership"===P?"Membership":"loyalty"===P?"Loyalty Point":"Restriction")}),(0,i.jsx)("button",{type:"button",onClick:O,className:"p-1 rounded-md hover:bg-gray-100",children:(0,i.jsx)(d.A,{className:"w-4 h-4"})})]}),(0,i.jsxs)("div",{className:"space-y-3",children:["restriction"!==P&&(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Name"}),(0,i.jsx)("input",{value:S.name,onChange:e=>M(t=>({...t,name:e.target.value})),className:"w-full px-3 py-2 rounded-lg border bg-white text-sm",placeholder:"Enter name",required:"restriction"!==P})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Description"}),(0,i.jsx)("textarea",{value:S.description,onChange:e=>M(t=>({...t,description:e.target.value})),className:"w-full px-3 py-2 rounded-lg border bg-white text-sm min-h-[80px]",placeholder:"Short description"})]}),"membership"===P&&(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Spending"}),(0,i.jsx)("input",{type:"number",value:S.spending,onChange:e=>M(t=>({...t,spending:e.target.value})),className:"w-full px-3 py-2 rounded-lg border bg-white text-sm",placeholder:"Enter spending amount",required:!0})]}),"loyalty"===P&&(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Points"}),(0,i.jsx)("input",{type:"number",value:S.points,onChange:e=>M(t=>({...t,points:e.target.value})),className:"w-full px-3 py-2 rounded-lg border bg-white text-sm",placeholder:"Enter points",required:!0})]}),"restriction"===P&&(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-xs text-gray-600 mb-1",children:"Restriction Limit"}),(0,i.jsx)("input",{type:"number",value:S.number,onChange:e=>M(t=>({...t,number:e.target.value})),className:"w-full px-3 py-2 rounded-lg border bg-white text-sm",placeholder:"Enter restriction number",required:!0})]})]}),(0,i.jsxs)("div",{className:"mt-6 flex items-center justify-end gap-2",children:[(0,i.jsx)("button",{type:"button",onClick:O,className:"px-4 py-2 text-sm rounded-lg border bg-gray-50 hover:bg-gray-100",children:"Cancel"}),(0,i.jsxs)("button",{type:"submit",disabled:E,className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-indigo-600 text-white shadow hover:bg-indigo-700 disabled:opacity-50",children:[(0,i.jsx)(o.A,{className:"w-4 h-4"}),E?"Saving...":"Save"]})]})]},"modal-panel")]},"modal-overlay")})]})}},60760:(e,t,s)=>{"use strict";s.d(t,{N:()=>y});var i=s(95155),r=s(12115),n=s(90869),a=s(82885),l=s(97494),d=s(80845),o=s(27351),c=s(51508);class m extends r.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,s=(0,o.s)(e)&&e.offsetWidth||0,i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft,i.right=s-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function u(e){let{children:t,isPresent:s,anchorX:n,root:a}=e,l=(0,r.useId)(),d=(0,r.useRef)(null),o=(0,r.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:u}=(0,r.useContext)(c.Q);return(0,r.useInsertionEffect)(()=>{let{width:e,height:t,top:i,left:r,right:c}=o.current;if(s||!d.current||!e||!t)return;d.current.dataset.motionPopId=l;let m=document.createElement("style");u&&(m.nonce=u);let h=null!=a?a:document.head;return h.appendChild(m),m.sheet&&m.sheet.insertRule('\n          [data-motion-pop-id="'.concat(l,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            ").concat("left"===n?"left: ".concat(r):"right: ".concat(c),"px !important;\n            top: ").concat(i,"px !important;\n          }\n        ")),()=>{h.contains(m)&&h.removeChild(m)}},[s]),(0,i.jsx)(m,{isPresent:s,childRef:d,sizeRef:o,children:r.cloneElement(t,{ref:d})})}let h=e=>{let{children:t,initial:s,isPresent:n,onExitComplete:l,custom:o,presenceAffectsLayout:c,mode:m,anchorX:h,root:x}=e,g=(0,a.M)(p),b=(0,r.useId)(),y=!0,f=(0,r.useMemo)(()=>(y=!1,{id:b,initial:s,isPresent:n,custom:o,onExitComplete:e=>{for(let t of(g.set(e,!0),g.values()))if(!t)return;l&&l()},register:e=>(g.set(e,!1),()=>g.delete(e))}),[n,g,l]);return c&&y&&(f={...f}),(0,r.useMemo)(()=>{g.forEach((e,t)=>g.set(t,!1))},[n]),r.useEffect(()=>{n||g.size||!l||l()},[n]),"popLayout"===m&&(t=(0,i.jsx)(u,{isPresent:n,anchorX:h,root:x,children:t})),(0,i.jsx)(d.t.Provider,{value:f,children:t})};function p(){return new Map}var x=s(32082);let g=e=>e.key||"";function b(e){let t=[];return r.Children.forEach(e,e=>{(0,r.isValidElement)(e)&&t.push(e)}),t}let y=e=>{let{children:t,custom:s,initial:d=!0,onExitComplete:o,presenceAffectsLayout:c=!0,mode:m="sync",propagate:u=!1,anchorX:p="left",root:y}=e,[f,v]=(0,x.xQ)(u),j=(0,r.useMemo)(()=>b(t),[t]),N=u&&!f?[]:j.map(g),w=(0,r.useRef)(!0),k=(0,r.useRef)(j),A=(0,a.M)(()=>new Map),[P,C]=(0,r.useState)(j),[S,M]=(0,r.useState)(j);(0,l.E)(()=>{w.current=!1,k.current=j;for(let e=0;e<S.length;e++){let t=g(S[e]);N.includes(t)?A.delete(t):!0!==A.get(t)&&A.set(t,!1)}},[S,N.length,N.join("-")]);let E=[];if(j!==P){let e=[...j];for(let t=0;t<S.length;t++){let s=S[t],i=g(s);N.includes(i)||(e.splice(t,0,s),E.push(s))}return"wait"===m&&E.length&&(e=E),M(b(e)),C(j),null}let{forceRender:R}=(0,r.useContext)(n.L);return(0,i.jsx)(i.Fragment,{children:S.map(e=>{let t=g(e),r=(!u||!!f)&&(j===S||N.includes(t));return(0,i.jsx)(h,{isPresent:r,initial:(!w.current||!!d)&&void 0,custom:s,presenceAffectsLayout:c,mode:m,root:y,onExitComplete:r?void 0:()=>{if(!A.has(t))return;A.set(t,!0);let e=!0;A.forEach(t=>{t||(e=!1)}),e&&(null==R||R(),M(k.current),u&&(null==v||v()),o&&o())},anchorX:p,children:e},t)})})}},62525:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});let i=(0,s(19946).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},84616:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});let i=(0,s(19946).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])}},e=>{e.O(0,[9135,7210,1748,9051,9323,8441,5964,7358],()=>e(e.s=39342)),_N_E=e.O()}]);