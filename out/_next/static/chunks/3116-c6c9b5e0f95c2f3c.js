"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3116],{43116:(r,e,t)=>{t.d(e,{Ah:()=>d,CX:()=>k,Gz:()=>F,K7:()=>l,SN:()=>v,Ub:()=>p,VW:()=>z,YF:()=>n,Zn:()=>Z,_i:()=>H,bU:()=>u,bm:()=>A,fl:()=>U,h1:()=>h,hs:()=>f,je:()=>g,kQ:()=>G,n$:()=>S,pv:()=>y,st:()=>s,w4:()=>c,ys:()=>E});var a=t(35317),i=t(56104);let o=null;(0,i.Gg)()&&i.db&&(o=(0,a.rJ)(i.db,"categories"));let n=r=>new Promise((e,t)=>{let a=new FileReader;a.onload=()=>{a.result?e(a.result):t(Error("Failed to convert file to base64"))},a.onerror=()=>t(Error("Error reading file")),a.readAsDataURL(r)}),c=function(r){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:800,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.8;return new Promise((a,i)=>{let o=document.createElement("canvas"),n=o.getContext("2d"),c=new Image;c.onload=()=>{let r=Math.min(e/c.width,e/c.height);o.width=c.width*r,o.height=c.height*r,null==n||n.drawImage(c,0,0,o.width,o.height),a(o.toDataURL("image/jpeg",t))},c.onerror=()=>i(Error("Error loading image")),c.src=URL.createObjectURL(r)})},d=async r=>{try{var e;if(!o)throw Error("Categories collection not initialized");return(await (0,a.gS)(o,{name:r.name||"Unnamed Category",description:r.description||"",serviceCount:null!=(e=r.serviceCount)?e:0,color:r.color||"#ffffff",gender:r.gender||"unisex",branch:r.branch||"",imageBase64:r.imageBase64||"",createdAt:a.Dc.now(),updatedAt:a.Dc.now()})).id}catch(r){throw console.error("Error adding category:",r),r}},s=async(r,e)=>{try{if(!(0,i.Gg)()||!i.db)throw Error("Firebase is not configured");let t=(0,a.H9)(i.db,"categories",r);await (0,a.mZ)(t,{...e,branch:e.branch||"",updatedAt:a.Dc.now()})}catch(r){throw console.error("Error updating category:",r),r}},l=async r=>{try{if(!(0,i.Gg)()||!i.db)throw Error("Firebase is not configured");let e=(0,a.H9)(i.db,"categories",r);await (0,a.kd)(e)}catch(r){throw console.error("Error deleting category:",r),r}},g=(r,e)=>{if(!o)return()=>{};let t=(0,a.P)(o,(0,a.My)("createdAt","desc"));return(0,a.aQ)(t,e=>{r(e.docs.map(r=>({id:r.id,...r.data()})))},r=>{console.error("Error listening to categories:",r),e&&e(r)})},w=async r=>{if(!o)return null;let e=(0,a.P)(o,(0,a._M)("name","==",r)),t=await (0,a.GG)(e);return t.empty?null:t.docs[0].id},b=null;(0,i.Gg)()&&i.db&&(b=(0,a.rJ)(i.db,"services"));let h=async r=>{try{var e,t,o;if(!b)throw Error("Services collection not initialized");let n=null;r.category&&(n=await w(r.category));let c=await (0,a.gS)(b,{name:r.name||"Unnamed Service",category:r.category||"",categoryId:n||"",duration:null!=(e=r.duration)?e:0,price:null!=(t=r.price)?t:0,description:r.description||"",isActive:null==(o=r.isActive)||o,branch:r.branch,imageBase64:r.imageBase64||"",createdAt:a.Dc.now(),updatedAt:a.Dc.now()});if(n){let r=(0,a.H9)(i.db,"categories",n);await (0,a.mZ)(r,{serviceCount:(0,a.GV)(1)})}return c.id}catch(r){throw console.error("Error adding service:",r),r}},u=async(r,e)=>{try{if(!(0,i.Gg)()||!i.db)throw Error("Firebase is not configured");let t=(0,a.H9)(i.db,"services",r);await (0,a.mZ)(t,{...e,branch:e.branch,updatedAt:a.Dc.now()})}catch(r){throw console.error("Error updating service:",r),r}},f=async(r,e,t)=>{try{if(!(0,i.Gg)()||!i.db)throw Error("Firebase is not configured");let o=(0,a.H9)(i.db,"services",r);await (0,a.kd)(o);let n=t;if(!n&&e&&(n=await w(e)),n){let r=(0,a.H9)(i.db,"categories",n);await (0,a.mZ)(r,{serviceCount:(0,a.GV)(-1)})}}catch(r){throw console.error("Error deleting service:",r),r}},y=(r,e)=>{if(!b)return()=>{};let t=(0,a.P)(b,(0,a.My)("createdAt","desc"));return(0,a.aQ)(t,e=>{r(e.docs.map(r=>({id:r.id,...r.data()})))},r=>{console.error("Error listening to services:",r),e&&e(r)})},m=null;(0,i.Gg)()&&i.db&&(m=(0,a.rJ)(i.db,"branches"));let E=async r=>{if(!m)throw Error("Branches collection not initialized");return(await (0,a.gS)(m,{...r,createdAt:a.Dc.now(),updatedAt:a.Dc.now()})).id},p=async(r,e)=>{if(!i.db)throw Error("Firebase is not configured");let t=(0,a.H9)(i.db,"branches",r);await (0,a.mZ)(t,{...e,updatedAt:a.Dc.now()})},v=async r=>{if(!i.db)throw Error("Firebase is not configured");let e=(0,a.H9)(i.db,"branches",r);await (0,a.kd)(e)},A=r=>m?(0,a.aQ)(m,e=>{r(e.docs.map(r=>({id:r.id,...r.data()})))}):()=>{},D=null;(0,i.Gg)()&&i.db&&(D=(0,a.rJ)(i.db,"offers"));let G=async r=>{if(!D)throw Error("Offers collection not initialized");return(await (0,a.gS)(D,{...r,createdAt:a.Dc.now(),updatedAt:a.Dc.now()})).id},F=async(r,e)=>{if(!i.db)throw Error("Firebase is not configured");let t=(0,a.H9)(i.db,"offers",r);await (0,a.mZ)(t,{...e,updatedAt:a.Dc.now()})},H=async r=>{if(!i.db)throw Error("Firebase is not configured");let e=(0,a.H9)(i.db,"offers",r);await (0,a.kd)(e)},k=r=>D?(0,a.aQ)(D,e=>{r(e.docs.map(r=>({id:r.id,...r.data()})))}):()=>{},C=null;(0,i.Gg)()&&i.db&&(C=(0,a.rJ)(i.db,"referrals"));let S=async r=>{if(!C)throw Error("Referrals collection not initialized");return(await (0,a.gS)(C,{...r,createdAt:a.Dc.now()})).id},U=async(r,e)=>{if(!i.db)throw Error("Firebase is not configured");let t=(0,a.H9)(i.db,"referrals",r);await (0,a.mZ)(t,e)},Z=async r=>{if(!i.db)throw Error("Firebase is not configured");let e=(0,a.H9)(i.db,"referrals",r);await (0,a.kd)(e)},z=r=>C?(0,a.aQ)(C,e=>{r(e.docs.map(r=>({id:r.id,...r.data()})))}):()=>{}}}]);